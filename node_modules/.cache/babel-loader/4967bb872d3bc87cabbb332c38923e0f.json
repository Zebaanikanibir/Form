{"ast":null,"code":"import _objectSpread from\"E:/form-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"E:/form-client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useContext,useState}from'react';import{useForm}from'react-hook-form';import firebase from\"firebase/app\";import{UserContext}from'../../App';import{useHistory,useLocation}from'react-router-dom';import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Login=function Login(){var _useContext=useContext(UserContext),_useContext2=_slicedToArray(_useContext,2),loggedInUser=_useContext2[0],setLoggedInUser=_useContext2[1];var history=useHistory();var location=useLocation();var _ref=location.state||{from:{pathname:\"/\"}},from=_ref.from;var _useForm=useForm({mode:\"onChange\"}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,errors=_useForm.formState.errors;var _useState=useState({isSignedIn:false,name:'',email:'',photo:'',password:''}),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var onSubmit=function onSubmit(data){if(data.email&&data.password){firebase.auth().signInWithEmailAndPassword(data.email,data.password).then(function(userCredential){// Signed in\nvar _userCredential$user=userCredential.user,displayName=_userCredential$user.displayName,email=_userCredential$user.email,photoURL=_userCredential$user.photoURL,password=_userCredential$user.password;var signedInUser={isSignedIn:true,name:displayName,email:email,photo:photoURL,password:password};setUser(signedInUser);setLoggedInUser(signedInUser);console.log(displayName,email,password);storeAuthToken();history.replace(from);}).catch(function(error){var errorCode=error.code;var errorMessage=error.message;if(errorMessage){alert(errorMessage);}});}var storeAuthToken=function storeAuthToken(){firebase.auth().currentUser.getIdToken(/* forceRefresh */true).then(function(idToken){console.log('token',idToken);sessionStorage.setItem('token',idToken);setTimeout(function(){sessionStorage.clear();},300000);history.replace(from);}).catch(function(error){// Handle error\n});};};return/*#__PURE__*/_jsxs(\"div\",{className:\"App mt-5\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Log In\"}),/*#__PURE__*/_jsxs(\"form\",{id:\"logedIn\",onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input\",id:\"email\",type:\"email\",placeholder:\"Enter Email\"},register('email',{required:\"this is a required\",pattern:{value:/^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,message:\"Invalid email address\"}}))),\" \",/*#__PURE__*/_jsx(\"br\",{}),errors.email&&/*#__PURE__*/_jsx(\"p\",{children:errors.email.message}),/*#__PURE__*/_jsx(\"input\",_objectSpread({className:\"input\",id:\"password\",type:\"password\",placeholder:\"password\"},register('password',{required:\"this is a required\",maxLength:{value:10,message:\"incorrect\"}}))),\" \",/*#__PURE__*/_jsx(\"br\",{}),errors.password&&/*#__PURE__*/_jsx(\"p\",{children:errors.password.message}),/*#__PURE__*/_jsx(\"input\",{className:\"input primary\",type:\"submit\"})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"register here  \",/*#__PURE__*/_jsx(Link,{to:\"/register\",children:\"Register\"})]})]});};export default Login;","map":{"version":3,"sources":["E:/form-client/src/Components/Login/Login.js"],"names":["React","useContext","useState","useForm","firebase","UserContext","useHistory","useLocation","Link","Login","loggedInUser","setLoggedInUser","history","location","state","from","pathname","mode","register","handleSubmit","errors","formState","isSignedIn","name","email","photo","password","user","setUser","onSubmit","data","auth","signInWithEmailAndPassword","then","userCredential","displayName","photoURL","signedInUser","console","log","storeAuthToken","replace","catch","error","errorCode","code","errorMessage","message","alert","currentUser","getIdToken","idToken","sessionStorage","setItem","setTimeout","clear","required","pattern","value","maxLength"],"mappings":"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","sourcesContent":["import React, { useContext, useState } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport firebase from \"firebase/app\"\r\nimport { UserContext } from '../../App';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\n\r\nimport {\r\n   \r\n    Link\r\n  } from \"react-router-dom\";\r\n\r\nconst Login = () => {\r\n    const [loggedInUser, setLoggedInUser] = useContext(UserContext)\r\n    const history = useHistory()\r\n  const location = useLocation()\r\n  let { from } = location.state || { from: { pathname: \"/\" } };\r\n    const { register, handleSubmit, formState: {\r\n        errors\r\n\r\n    } } = useForm({\r\n        mode: \"onChange\"\r\n    });\r\n    const [user, setUser] = useState({\r\n        isSignedIn: false,\r\n        name: '',\r\n        email: '',\r\n        photo: '',\r\n        password:''\r\n\r\n    })\r\nconst onSubmit =(data) =>{\r\n    \r\n    \r\n    if(data.email&& data.password){\r\n        firebase.auth().signInWithEmailAndPassword(data.email, data.password)\r\n    .then((userCredential) => {\r\n      // Signed in\r\n     \r\n      const { displayName, email, photoURL, password } = userCredential.user;\r\n      const signedInUser = {\r\n          isSignedIn: true,\r\n          name: displayName,\r\n          email: email,\r\n          photo: photoURL,\r\n          password:password\r\n      }\r\n      setUser(signedInUser)\r\n      setLoggedInUser(signedInUser);\r\n      console.log(displayName, email, password);\r\n      storeAuthToken()\r\n      history.replace(from);\r\n    })\r\n    .catch((error) => {\r\n      var errorCode = error.code;\r\n      var errorMessage = error.message;\r\n      if(errorMessage){\r\n     alert(errorMessage)\r\n      }\r\n    });\r\n    }\r\n    const storeAuthToken = () =>{\r\n        firebase.auth().currentUser.getIdToken(/* forceRefresh */ true).then(function(idToken) {\r\n            console.log('token', idToken)\r\n           sessionStorage.setItem('token', idToken)\r\n    setTimeout(function() {\r\n    sessionStorage.clear()\r\n    },300000)\r\n\r\n           history.replace(from);\r\n          }).catch(function(error) {\r\n            // Handle error\r\n          });\r\n    }\r\n}\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"App mt-5\">\r\n            <h3>Log In</h3>\r\n              <form id=\"logedIn\" onSubmit={handleSubmit(onSubmit)}>\r\n             \r\n                <input className=\"input\" id=\"email\" type=\"email\" placeholder=\"Enter Email\"{...register('email', {\r\n                    required: \"this is a required\", pattern: {\r\n                        value: /^[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/,\r\n                        message: \"Invalid email address\"\r\n                    }\r\n                })} /> <br />\r\n                {errors.email && <p>{errors.email.message}</p>}\r\n              <input className=\"input\" id=\"password\" type=\"password\" placeholder=\"password\" {...register('password', {\r\n                    required: \"this is a required\", maxLength: {\r\n                        value: 10,\r\n                        message: \"incorrect\"\r\n                    }\r\n                })} /> <br />\r\n                {errors.password && <p>{errors.password.message}</p>}\r\n                <input className=\"input primary\" type=\"submit\" />\r\n              </form>\r\n              <p>register here  <Link to=\"/register\">Register</Link></p>\r\n              \r\n\r\n            \r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Login;"]},"metadata":{},"sourceType":"module"}